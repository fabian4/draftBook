<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/draftbook/assets/css/0.styles.1b62e20f.css" as="style"><link rel="preload" href="/draftbook/assets/js/app.a7c61d12.js" as="script"><link rel="preload" href="/draftbook/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/draftbook/assets/js/7.4c552ee7.js" as="script"><link rel="prefetch" href="/draftbook/assets/js/10.b8a6f5f4.js"><link rel="prefetch" href="/draftbook/assets/js/3.414988de.js"><link rel="prefetch" href="/draftbook/assets/js/4.d12742be.js"><link rel="prefetch" href="/draftbook/assets/js/5.216cae74.js"><link rel="prefetch" href="/draftbook/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/draftbook/assets/js/8.a9a56dd4.js"><link rel="prefetch" href="/draftbook/assets/js/9.1183d564.js">
    <link rel="stylesheet" href="/draftbook/assets/css/0.styles.1b62e20f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>BigData</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Spark</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draftbook/BigData/Spark/RDD算子.html" class="active sidebar-link">RDD算子.md</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/draftbook/BigData/Spark/RDD算子.html#首先来引入一个wordcount的例子" class="sidebar-link">首先来引入一个WordCount的例子</a></li><li class="sidebar-sub-header"><a href="/draftbook/BigData/Spark/RDD算子.html#rdd的编程模型和延迟计算" class="sidebar-link">RDD的编程模型和延迟计算</a></li><li class="sidebar-sub-header"><a href="/draftbook/BigData/Spark/RDD算子.html#transformations类算子" class="sidebar-link">Transformations类算子</a></li><li class="sidebar-sub-header"><a href="/draftbook/BigData/Spark/RDD算子.html#actions类算子" class="sidebar-link">Actions类算子</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ConfigCenter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Gateway</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>RDD是Spark对于分布式数据的统一抽象，用于囊括所有内存中和磁盘中的分布式数据实体。
RDD的全称是Resilient Distributed Dataset，即 “弹性分布式数据集”。它定义了一系列分布式数据的基本属性与处理方法。</p></blockquote> <h1 id="一、helloword"><a href="#一、helloword" class="header-anchor">#</a> 一、HelloWord</h1> <h2 id="首先来引入一个wordcount的例子"><a href="#首先来引入一个wordcount的例子" class="header-anchor">#</a> 首先来引入一个WordCount的例子</h2> <hr> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span></span>RDD 

<span class="token comment">// 这里的下划线&quot;_&quot;是占位符，代表数据文件的根目录 </span>
<span class="token keyword">val</span> rootPath<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> _ <span class="token keyword">val</span> file<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">rootPath</span><span class="token punctuation">}</span></span><span class="token string">/text.txt&quot;</span></span> 

<span class="token comment">// 读取文件内容 </span>
<span class="token keyword">val</span> lineRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> spark<span class="token punctuation">.</span>sparkContext<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span>file<span class="token punctuation">)</span> 

<span class="token comment">// 以行为单位做分词 </span>
<span class="token keyword">val</span> wordRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> lineRDD<span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">val</span> cleanWordRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> wordRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>word <span class="token keyword">=&gt;</span> <span class="token operator">!</span>word<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token comment">// 把RDD元素转换为（Key，Value）的形式 </span>
<span class="token keyword">val</span> kvRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> cleanWordRDD<span class="token punctuation">.</span>map<span class="token punctuation">(</span>word <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>word<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token comment">// 按照单词做分组计数 </span>
<span class="token keyword">val</span> wordCounts<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> kvRDD<span class="token punctuation">.</span>reduceByKey<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span> 

<span class="token comment">// 打印词频最高的5个词汇 </span>
wordCounts<span class="token punctuation">.</span>map<span class="token punctuation">{</span><span class="token keyword">case</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>v<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span>sortByKey<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><p>看这段代码中的 RDD</p> <div class="language- extra-class"><pre><code>源文件 -&gt; lineRDD -&gt; wordRDD -&gt; cleadWordRDD -&gt; kvRDD -&gt; wordCounts
</code></pre></div><p>在数据形态的转换过程中，每个RDD都会通过dependencies属性来记录它所依赖的前一个、或是多个RDD，简称“父RDD”。与此同时，RDD使用compute属性，来记录从父RDD到当前RDD的转换操作。</p> <p>拿Word Count当中的wordRDD来举例，它的父RDD是lineRDD，因此，它的dependencies属性记录的是lineRDD。从lineRDD到wordRDD的转换，其所依赖的操作是flatMap，因此，wordRDD的compute属性，记录的是flatMap这个转换函数。而这其中的 <code>flatMap</code> 、<code>filter</code>、<code>map</code>、<code>reduceByKey</code> 就被称为算子。</p> <p>RDD有四大属性：</p> <ul><li>partitions：数据分片 —— 即 数据实体的具体不同形态</li> <li>partitioner：分片切割规则 —— 即 数据不同形态的划分规则</li> <li>dependencies：RDD依赖 —— 即 对前一个或是多个RDD的依赖</li> <li>compute：转换函数 —— 即 从上一种形态转变为当前形态的方式</li></ul> <h2 id="rdd的编程模型和延迟计算"><a href="#rdd的编程模型和延迟计算" class="header-anchor">#</a> RDD的编程模型和延迟计算</h2> <hr> <blockquote><p>编程模型指导我们如何进行代码实现，而延迟计算是Spark分布式运行机制的基础。</p></blockquote> <ol><li>通过调用textFile API生成lineRDD，然后用flatMap算子把lineRDD转换为wordRDD；</li> <li>接下来，filter算子对wordRDD做过滤，并把它转换为不带空串的cleanWordRDD；</li> <li>然后，为了后续的聚合计算，map算子把cleanWordRDD又转换成元素为（Key，Value）对的kvRDD；</li> <li>最终，我们调用reduceByKey做分组聚合，把kvRDD中的Value从1转换为单词计数。</li></ol> <blockquote><p>开发者调用的各类Transformations算子，并不立即执行计算，当且仅当开发者调用Actions算子时，之前调用的转换算子才会付诸执行。这就被称为 “<strong>延迟计算</strong>”（Lazy Evaluation）。</p></blockquote> <h1 id="二、rdd算子"><a href="#二、rdd算子" class="header-anchor">#</a> 二、RDD算子</h1> <blockquote><p>Spark官网给出的算子：https://spark.apache.org/docs/latest/rdd-programming-guide.html</p></blockquote> <h2 id="transformations类算子"><a href="#transformations类算子" class="header-anchor">#</a> Transformations类算子</h2> <hr> <table><thead><tr><th style="text-align:center;">适用范围</th> <th style="text-align:center;">算子用途</th> <th style="text-align:center;">算子合集</th></tr></thead> <tbody><tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">RDD内数据转化</td> <td style="text-align:center;">map / flatmap / fliter / mapPartitons / mapPartitionsWithIndex</td></tr> <tr><td style="text-align:center;">Parid RDD</td> <td style="text-align:center;">RDD内数据聚合</td> <td style="text-align:center;">groupByKey / sortByKey / reduceByKey / aggregateByKey</td></tr> <tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">RDD间数据整合</td> <td style="text-align:center;">union / intersection / join / cogroup / cartesian</td></tr> <tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">数据整理</td> <td style="text-align:center;">sample / distinct</td></tr> <tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">数据分布</td> <td style="text-align:center;">coalesce / repartition / repartitionAndSortWithinPartitions</td></tr></tbody></table> <h2 id="actions类算子"><a href="#actions类算子" class="header-anchor">#</a> Actions类算子</h2> <hr> <table><thead><tr><th style="text-align:center;">适用范围</th> <th style="text-align:center;">算子用途</th> <th style="text-align:center;">算子集合</th></tr></thead> <tbody><tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">数据收集</td> <td style="text-align:center;">collect / first / take / count / takeSample / takeOrdered</td></tr> <tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">数据持久化</td> <td style="text-align:center;">saveAsTextFile / saveAsSequenceFile / saveAsObjectFile</td></tr> <tr><td style="text-align:center;">任意RDD</td> <td style="text-align:center;">数据遍历</td> <td style="text-align:center;">foreach</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/draftbook/ConfigCenter/Polaris/未命名.html">
        未命名.md
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/draftbook/assets/js/app.a7c61d12.js" defer></script><script src="/draftbook/assets/js/2.733019b2.js" defer></script><script src="/draftbook/assets/js/7.4c552ee7.js" defer></script>
  </body>
</html>
